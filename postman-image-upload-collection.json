{
  "info": {
    "_postman_id": "image-upload-collection",
    "name": "General Store - Image Upload API",
    "description": "Image upload, deletion, and retrieval endpoints",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "Upload",
      "item": [
        {
          "name": "Upload Single Image",
          "id": "upload-single",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    var jsonData = pm.response.json();",
                  "    pm.environment.set('image_url', jsonData.data.url);",
                  "    pm.environment.set('image_filename', jsonData.data.filename);",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [],
            "body": {
              "mode": "formdata",
              "formdata": [
                {
                  "key": "image",
                  "type": "file",
                  "src": []
                },
                {
                  "key": "folder",
                  "value": "products",
                  "type": "text"
                }
              ]
            },
            "url": {
              "raw": "{{base_url}}/api/upload",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "upload"
              ]
            },
            "description": "Upload a single image file"
          },
          "response": []
        },
        {
          "name": "Upload Product Image",
          "id": "upload-product",
          "request": {
            "method": "POST",
            "header": [],
            "body": {
              "mode": "formdata",
              "formdata": [
                {
                  "key": "image",
                  "type": "file",
                  "src": []
                }
              ]
            },
            "url": {
              "raw": "{{base_url}}/api/upload?folder=products",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "upload"
              ],
              "query": [
                {
                  "key": "folder",
                  "value": "products"
                }
              ]
            },
            "description": "Upload product image"
          },
          "response": []
        },
        {
          "name": "Upload Profile Picture",
          "id": "upload-profile",
          "request": {
            "method": "POST",
            "header": [],
            "body": {
              "mode": "formdata",
              "formdata": [
                {
                  "key": "image",
                  "type": "file",
                  "src": []
                }
              ]
            },
            "url": {
              "raw": "{{base_url}}/api/upload?folder=profiles",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "upload"
              ],
              "query": [
                {
                  "key": "folder",
                  "value": "profiles"
                }
              ]
            },
            "description": "Upload user profile picture"
          },
          "response": []
        },
        {
          "name": "Upload Banner Image",
          "id": "upload-banner",
          "request": {
            "method": "POST",
            "header": [],
            "body": {
              "mode": "formdata",
              "formdata": [
                {
                  "key": "image",
                  "type": "file",
                  "src": []
                }
              ]
            },
            "url": {
              "raw": "{{base_url}}/api/upload?folder=banners",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "upload"
              ],
              "query": [
                {
                  "key": "folder",
                  "value": "banners"
                }
              ]
            },
            "description": "Upload banner image"
          },
          "response": []
        },
        {
          "name": "Upload Multiple Images",
          "id": "upload-batch",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    var jsonData = pm.response.json();",
                  "    pm.environment.set('images_count', jsonData.data.count);",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [],
            "body": {
              "mode": "formdata",
              "formdata": [
                {
                  "key": "images",
                  "type": "file",
                  "src": []
                },
                {
                  "key": "images",
                  "type": "file",
                  "src": []
                },
                {
                  "key": "folder",
                  "value": "products",
                  "type": "text"
                }
              ]
            },
            "url": {
              "raw": "{{base_url}}/api/upload/batch",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "upload",
                "batch"
              ]
            },
            "description": "Upload multiple images at once (max 5)"
          },
          "response": []
        }
      ]
    },
    {
      "name": "Delete",
      "item": [
        {
          "name": "Delete Image by URL",
          "id": "delete-image",
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"cloudinaryId\": \"optional-id-for-cloudinary\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/upload/{{image_filename}}",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "upload",
                "{{image_filename}}"
              ]
            },
            "description": "Delete an uploaded image"
          },
          "response": []
        },
        {
          "name": "Delete Non-existent Image",
          "id": "delete-nonexistent",
          "request": {
            "method": "DELETE",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/upload/nonexistent-image.jpg",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "upload",
                "nonexistent-image.jpg"
              ]
            },
            "description": "Try to delete a non-existent image"
          },
          "response": []
        }
      ]
    },
    {
      "name": "Retrieve",
      "item": [
        {
          "name": "Get Image Information",
          "id": "get-image-info",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/upload/info/{{image_filename}}",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "upload",
                "info",
                "{{image_filename}}"
              ]
            },
            "description": "Get information about an uploaded image including variants"
          },
          "response": []
        },
        {
          "name": "Get Image with Cloudinary ID",
          "id": "get-image-info-cloudinary",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/upload/info/cloudinary-public-id?cloudinaryId=general-store/products/image123",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "upload",
                "info",
                "cloudinary-public-id"
              ],
              "query": [
                {
                  "key": "cloudinaryId",
                  "value": "general-store/products/image123"
                }
              ]
            },
            "description": "Get image information for Cloudinary-hosted image"
          },
          "response": []
        }
      ]
    },
    {
      "name": "Serve",
      "item": [
        {
          "name": "View Uploaded Image",
          "id": "view-image",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/images/products/{{image_filename}}",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "images",
                "products",
                "{{image_filename}}"
              ]
            },
            "description": "View/download the actual uploaded image (local storage only)"
          },
          "response": []
        }
      ]
    },
    {
      "name": "Error Cases",
      "item": [
        {
          "name": "Upload Invalid File Type",
          "id": "upload-invalid-type",
          "request": {
            "method": "POST",
            "header": [],
            "body": {
              "mode": "formdata",
              "formdata": [
                {
                  "key": "image",
                  "value": "This is a text file, not an image",
                  "type": "text"
                }
              ]
            },
            "url": {
              "raw": "{{base_url}}/api/upload",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "upload"
              ]
            },
            "description": "Try uploading a non-image file (should fail)"
          },
          "response": []
        },
        {
          "name": "Upload with No File",
          "id": "upload-no-file",
          "request": {
            "method": "POST",
            "header": [],
            "body": {
              "mode": "formdata",
              "formdata": [
                {
                  "key": "folder",
                  "value": "products",
                  "type": "text"
                }
              ]
            },
            "url": {
              "raw": "{{base_url}}/api/upload",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "upload"
              ]
            },
            "description": "Try uploading without selecting a file (should fail)"
          },
          "response": []
        },
        {
          "name": "Upload to Invalid Folder",
          "id": "upload-invalid-folder",
          "request": {
            "method": "POST",
            "header": [],
            "body": {
              "mode": "formdata",
              "formdata": [
                {
                  "key": "image",
                  "type": "file",
                  "src": []
                },
                {
                  "key": "folder",
                  "value": "invalid-folder",
                  "type": "text"
                }
              ]
            },
            "url": {
              "raw": "{{base_url}}/api/upload?folder=invalid-folder",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "upload"
              ],
              "query": [
                {
                  "key": "folder",
                  "value": "invalid-folder"
                }
              ]
            },
            "description": "Try uploading to an invalid folder"
          },
          "response": []
        }
      ]
    }
  ],
  "variable": [
    {
      "key": "base_url",
      "value": "http://localhost:5000",
      "type": "string"
    },
    {
      "key": "image_url",
      "value": "",
      "type": "string"
    },
    {
      "key": "image_filename",
      "value": "",
      "type": "string"
    },
    {
      "key": "images_count",
      "value": "0",
      "type": "string"
    }
  ]
}
